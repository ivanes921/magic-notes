<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1,user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" id="status-bar-style" />
  <title>Заметка</title>
  <style>
    :root{
      --bg: #ffffff;
      --text: #1c1c1e;
      --muted-icon: rgba(60,60,67,.30);      /* iOS grey (light) */
      --safe-t: env(safe-area-inset-top, 0px);
      --safe-b: env(safe-area-inset-bottom, 0px);
      --safe-l: env(safe-area-inset-left, 0px);
      --safe-r: env(safe-area-inset-right, 0px);
      --bar-h: 66px;                         /* высота топ-бара */
      --tool-h: 54px;                        /* высота нижней панели */
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg: #000000;
        --text: #f2f2f7;
        --muted-icon: rgba(235,235,245,.55); /* iOS grey (dark) */
      }
    }

    *{ box-sizing: border-box }
    html,body{ height:100% }
    body{
      margin:0;
      background:var(--bg);
      color: var(--text);
      font:16px/1 -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display", system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Верхняя панель */
    .topbar{
      position:sticky; top:0; z-index:10;
      height: calc(var(--bar-h) + var(--safe-t));
      padding-top: var(--safe-t);
      display:flex; align-items:center; justify-content:space-between;
      padding-left: calc(12px + var(--safe-l));
      padding-right: calc(8px + var(--safe-r));
      background: transparent;
    }
    .left, .right{ display:flex; align-items:center; }
    .right{ gap:7px; }
    .left .hit{ justify-content:flex-start; padding-left:0; gap:8px; }
    .left .hit svg{ height:44px; width:auto; }
    .left .hit svg.back-label{ height:22px; }
    .hit{ width:66px; height:66px; display:flex; align-items:center; justify-content:center; }

    /* Поле «листа» */
    .sheet{
      min-height: calc(100vh - var(--bar-h) - var(--tool-h) - var(--safe-t) - var(--safe-b));
      padding: 8px calc(12px + var(--safe-r)) 8px calc(24px + var(--safe-l));
      cursor: text;
    }

    .note{
      min-height: calc(100vh - var(--bar-h) - var(--tool-h) - var(--safe-t) - var(--safe-b) - 16px);
      outline: none;
      caret-color: #E4AF0A;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .note .title,
    .note .body{
      min-height: 1.2em;
      white-space: pre-wrap;
    }

    .note .title{
      font-size: 32px;
      font-weight: 700;
      line-height: 1.1;
      letter-spacing: -0.02em;
    }

    .note .body{
      font-size: 18px;
      line-height: 1.35;
    }

    .note .photo-block{
      border-radius: 12px;
      overflow: hidden;
      align-self: flex-start;
      max-width: 100%;
    }

    .note .photo-block img{
      display: block;
      width: 100%;
      height: auto;
    }

    /* Нижняя панель инструментов */
    .toolbar{
      position:fixed; left:0; right:0; bottom:0; z-index:10;
      height: calc(var(--tool-h) + var(--safe-b));
      padding: 4px calc(12px + var(--safe-r)) calc(8px + var(--safe-b)) calc(12px + var(--safe-l));
      display:flex; align-items:flex-end; justify-content:space-between;
      background: transparent;
    }
    .tool{ width:68px; height:44px; display:flex; align-items:center; justify-content:center; }

    /* Перекрашиваем «пассивные» иконки в зависимости от темы */
    .muted *{ fill: var(--muted-icon) !important; }

    /* Адаптивность для узких экранов */
    @media (max-width: 380px){
      .tool{ width:56px; }
    }
  </style>
</head>
<body>

  <!-- ВЕРХ -->
  <header class="topbar" role="navigation" aria-label="Навигация">
    <div class="left">
      <div class="hit" aria-label="Назад">
        <!-- Стрелка назад -->
        <svg class="back-arrow" width="12" height="20" viewBox="0 0 12 20" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M0 9.64648C0.00716146 9.42448 0.0501302 9.22038 0.128906 9.03418C0.214844 8.84798 0.34375 8.66895 0.515625 8.49707
L8.78711 0.408203C9.05924 0.136068 9.39225 0 9.78613 0C10.0583 0 10.3018 0.0644531 10.5166 0.193359C10.7386 0.322266 10.9141
0.497721 11.043 0.719727C11.179 0.93457 11.2471 1.17448 11.2471 1.43945C11.2471 1.84049 11.0967 2.19141 10.7959 2.49219L3.4375
9.64648L10.7959 16.8008C11.0967 17.1087 11.2471 17.4596 11.2471 17.8535C11.2471 18.1257 11.179 18.3691 11.043 18.584C10.9141
18.7988 10.7386 18.9707 10.5166 19.0996C10.3018 19.2285 10.0583 19.293 9.78613 19.293C9.39225 19.293 9.05924 19.1569 8.78711
18.8848L0.515625 10.7959C0.336589 10.624 0.204102 10.445 0.118164 10.2588C0.039388 10.0654 0 9.86133 0 9.64648Z" fill="#E4AF0A"/>
</svg>
        <!-- Надпись «Назад» -->
        <svg width="48" height="15" viewBox="0 0 48 15" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M0 11.978V0H1.49414V5.17969H8.06836V0H9.5625V11.978H8.06836V6.52441H1.49414V11.978H0ZM14.6276 12.1357C14.0632 12.1357 13.554 12.0278 13.1003 11.812C12.652 11.5962 12.2951 11.2891 12.0295 10.8906C11.7694 10.4922 11.6393 10.0218 11.6393 9.47949V9.46289C11.6393 8.93164 11.7666 8.47786 12.0212 8.10156C12.2757 7.71973 12.6465 7.4209 13.1335 7.20508C13.6205 6.98926 14.2098 6.86198 14.9015 6.82324L18.1887 6.62402V7.77783L15.0759 7.97705C14.3952 8.01579 13.8971 8.1569 13.5817 8.40039C13.2718 8.64388 13.1169 8.98698 13.1169 9.42969V9.44629C13.1169 9.90007 13.2884 10.2542 13.6315 10.5088C13.9746 10.7578 14.4063 10.8823 14.9264 10.8823C15.419 10.8823 15.8561 10.7855 16.238 10.5918C16.6198 10.3926 16.9186 10.1242 17.1345 9.78662C17.3558 9.44906 17.4665 9.06722 17.4665 8.64111V5.85205C17.4665 5.29867 17.2977 4.87809 16.9601 4.59033C16.6281 4.29704 16.1273 4.15039 15.4577 4.15039C14.9209 4.15039 14.481 4.24723 14.1379 4.44092C13.7948 4.62907 13.5651 4.89746 13.4489 5.24609L13.4406 5.271H11.9963L12.0046 5.22119C12.082 4.75081 12.2757 4.34131 12.5856 3.99268C12.9011 3.63851 13.3078 3.36458 13.8058 3.1709C14.3039 2.97168 14.8711 2.87207 15.5075 2.87207C16.238 2.87207 16.855 2.99105 17.3586 3.229C17.8677 3.46696 18.2523 3.81006 18.5124 4.2583C18.778 4.70101 18.9108 5.23226 18.9108 5.85205V11.978H17.4665V10.6582H17.3337C17.1455 10.9736 16.9159 11.242 16.6447 11.4634C16.3791 11.6847 16.0775 11.8535 15.7399 11.9697C15.4024 12.0804 15.0316 12.1357 14.6276 12.1357ZM24.3246 12.144C23.6882 12.144 23.1127 12.0444 22.598 11.8452C22.0889 11.646 21.6739 11.3693 21.3529 11.0151C21.0319 10.6554 20.841 10.2349 20.7801 9.75342L20.7718 9.68701H22.2411L22.2577 9.75342C22.3518 10.1187 22.5842 10.4092 22.9549 10.625C23.3257 10.8408 23.7823 10.9487 24.3246 10.9487C24.9831 10.9487 25.4977 10.8049 25.8685 10.5171C26.2393 10.2293 26.4247 9.8641 26.4247 9.42139V9.40479C26.4247 8.91781 26.2448 8.56087 25.8851 8.33398C25.5309 8.10156 25.0108 7.98535 24.3246 7.98535H22.93V6.79004H24.3246C24.9001 6.79004 25.34 6.6766 25.6444 6.44971C25.9543 6.21729 26.1092 5.86865 26.1092 5.40381V5.38721C26.1092 5.00537 25.9626 4.68994 25.6693 4.44092C25.3815 4.18636 24.9499 4.05908 24.3744 4.05908C23.8653 4.05908 23.4336 4.16423 23.0795 4.37451C22.7253 4.5848 22.5122 4.86979 22.4403 5.22949L22.432 5.271H21.0209L21.0292 5.21289C21.1011 4.73145 21.2837 4.31641 21.577 3.96777C21.8758 3.61361 22.2632 3.34245 22.7391 3.1543C23.2206 2.96061 23.7657 2.86377 24.3744 2.86377C25.044 2.86377 25.6112 2.96615 26.076 3.1709C26.5464 3.37565 26.9033 3.66064 27.1468 4.02588C27.3959 4.38558 27.5204 4.80339 27.5204 5.2793V5.2959C27.5204 5.74967 27.3848 6.15918 27.1136 6.52441C26.8425 6.88965 26.4855 7.12484 26.0428 7.22998V7.36279C26.4357 7.4458 26.765 7.57861 27.0306 7.76123C27.3018 7.94385 27.5038 8.16797 27.6366 8.43359C27.7749 8.69922 27.8441 8.99805 27.8441 9.33008V9.34668C27.8441 9.90007 27.6947 10.387 27.3959 10.8076C27.1026 11.2282 26.6903 11.5575 26.159 11.7954C25.6333 12.0278 25.0218 12.144 24.3246 12.144ZM32.2784 12.1357C31.7139 12.1357 31.2048 12.0278 30.751 11.812C30.3028 11.5962 29.9458 11.2891 29.6802 10.8906C29.4201 10.4922 29.2901 10.0218 29.2901 9.47949V9.46289C29.2901 8.93164 29.4174 8.47786 29.6719 8.10156C29.9265 7.71973 30.2972 7.4209 30.7842 7.20508C31.2712 6.98926 31.8606 6.86198 32.5523 6.82324L35.8394 6.62402V7.77783L32.7266 7.97705C32.0459 8.01579 31.5479 8.1569 31.2325 8.40039C30.9226 8.64388 30.7676 8.98698 30.7676 9.42969V9.44629C30.7676 9.90007 30.9392 10.2542 31.2823 10.5088C31.6254 10.7578 32.057 10.8823 32.5772 10.8823C33.0697 10.8823 33.5069 10.7855 33.8887 10.5918C34.2705 10.3926 34.5694 10.1242 34.7852 9.78662C35.0065 9.44906 35.1172 9.06722 35.1172 8.64111V5.85205C35.1172 5.29867 34.9484 4.87809 34.6109 4.59033C34.2788 4.29704 33.778 4.15039 33.1084 4.15039C32.5717 4.15039 32.1317 4.24723 31.7886 4.44092C31.4455 4.62907 31.2159 4.89746 31.0996 5.24609L31.0913 5.271H29.647L29.6553 5.22119C29.7328 4.75081 29.9265 4.34131 30.2364 3.99268C30.5518 3.63851 30.9585 3.36458 31.4566 3.1709C31.9546 2.97168 32.5218 2.87207 33.1582 2.87207C33.8887 2.87207 34.5057 2.99105 35.0093 3.229C35.5184 3.46696 35.903 3.81006 36.1631 4.2583C36.4287 4.70101 36.5616 5.23226 36.5616 5.85205V11.978H35.1172V10.6582H34.9844C34.7963 10.9736 34.5666 11.242 34.2954 11.4634C34.0298 11.6847 33.7282 11.8535 33.3907 11.9697C33.0531 12.0804 32.6823 12.1357 32.2784 12.1357ZM39.1364 14.3438H37.7917V10.7827H38.5388C38.8653 10.5669 39.1143 10.2044 39.2859 9.69531C39.4574 9.18066 39.5626 8.62174 39.6013 8.01855L39.9499 3.02979H46.051V10.7827H47.4787V14.3438H46.134V11.978H39.1364V14.3438ZM44.6067 10.7827V4.2251H41.2282L40.946 8.05176C40.9073 8.59408 40.827 9.09489 40.7053 9.5542C40.5835 10.008 40.4175 10.3732 40.2072 10.6499V10.7827H44.6067Z" fill="#E4AF0A"/>
</svg>

      </div>
    </div>

    <div class="right">
      <div class="hit muted" data-role="share" aria-label="Поделиться" aria-disabled="true">
        <!-- Поделиться -->
        <svg width="25" height="44" viewBox="0 0 25 44" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6.33398 33.7705C5.20964 33.7705 4.36458 33.4912 3.79883 32.9326C3.24023 32.3812 2.96094 31.5505 2.96094 30.4404V19.8379C2.96094 18.7279 3.24023 17.8971 3.79883 17.3457C4.36458 16.7871 5.20964 16.5078 6.33398 16.5078H9.62109V18.2373H6.35547C5.81836 18.2373 5.40658 18.3805 5.12012 18.667C4.83366 18.9463 4.69043 19.3652 4.69043 19.9238V30.3545C4.69043 30.9131 4.83366 31.332 5.12012 31.6113C5.40658 31.8978 5.81836 32.041 6.35547 32.041H18.623C19.153 32.041 19.5648 31.8978 19.8584 31.6113C20.152 31.332 20.2988 30.9131 20.2988 30.3545V19.9238C20.2988 19.3652 20.152 18.9463 19.8584 18.667C19.5648 18.3805 19.153 18.2373 18.623 18.2373H15.3574V16.5078H18.6553C19.7796 16.5078 20.6211 16.7871 21.1797 17.3457C21.7454 17.8971 22.0283 18.7279 22.0283 19.8379V30.4404C22.0283 31.5505 21.7454 32.3812 21.1797 32.9326C20.6211 33.4912 19.7796 33.7705 18.6553 33.7705H6.33398ZM12.4893 25.3486C12.2601 25.3486 12.0596 25.2663 11.8877 25.1016C11.723 24.9368 11.6406 24.7435 11.6406 24.5215V13.5859L11.7051 11.9854L11.1035 12.6191L9.43848 14.3916C9.28809 14.5635 9.09115 14.6494 8.84766 14.6494C8.62565 14.6494 8.43945 14.5778 8.28906 14.4346C8.14583 14.2913 8.07422 14.1123 8.07422 13.8975C8.07422 13.6898 8.16016 13.5 8.33203 13.3281L11.8662 9.91211C11.9808 9.80469 12.0846 9.73307 12.1777 9.69727C12.278 9.6543 12.3818 9.63281 12.4893 9.63281C12.6038 9.63281 12.7077 9.6543 12.8008 9.69727C12.901 9.73307 13.0049 9.80469 13.1123 9.91211L16.6572 13.3281C16.8219 13.5 16.9043 13.6898 16.9043 13.8975C16.9043 14.1123 16.8291 14.2913 16.6787 14.4346C16.5283 14.5778 16.3421 14.6494 16.1201 14.6494C15.8838 14.6494 15.6904 14.5635 15.54 14.3916L13.8857 12.6191L13.2842 11.9854L13.3486 13.5859V24.5215C13.3486 24.7435 13.2627 24.9368 13.0908 25.1016C12.9261 25.2663 12.7256 25.3486 12.4893 25.3486Z" fill="#E4AF0A"/>
</svg>

      </div>
      <div class="hit" aria-label="Меню">
        <svg width="25" height="44" viewBox="0 0 25 44" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12.5 33.2012C10.9889 33.2012 9.57096 32.9147 8.24609 32.3418C6.92122 31.776 5.75749 30.9919 4.75488 29.9893C3.75228 28.9867 2.96452 27.8229 2.3916 26.498C1.82585 25.1732 1.54297 23.7552 1.54297 22.2441C1.54297 20.7331 1.82585 19.3151 2.3916 17.9902C2.96452 16.6654 3.75228 15.5016 4.75488 14.499C5.75749 13.4893 6.92122 12.7015 8.24609 12.1357C9.57096 11.57 10.9889 11.2871 12.5 11.2871C14.0111 11.2871 15.429 11.57 16.7539 12.1357C18.0788 12.7015 19.2425 13.4893 20.2451 14.499C21.2477 15.5016 22.0319 16.6654 22.5977 17.9902C23.1706 19.3151 23.457 20.7331 23.457 22.2441C23.457 23.7552 23.1706 25.1732 22.5977 26.498C22.0319 27.8229 21.2477 28.9867 20.2451 29.9893C19.2425 30.9919 18.0788 31.776 16.7539 32.3418C15.429 32.9147 14.0111 33.2012 12.5 33.2012ZM12.5 31.375C13.7604 31.375 14.9421 31.1387 16.0449 30.666C17.1478 30.1934 18.1182 29.5381 18.9561 28.7002C19.7939 27.8623 20.4492 26.8919 20.9219 25.7891C21.3945 24.6862 21.6309 23.5046 21.6309 22.2441C21.6309 20.9837 21.3945 19.8021 20.9219 18.6992C20.4492 17.5892 19.7939 16.6188 18.9561 15.7881C18.1182 14.9502 17.1478 14.2949 16.0449 13.8223C14.9421 13.3496 13.7604 13.1133 12.5 13.1133C11.2396 13.1133 10.0579 13.3496 8.95508 13.8223C7.85221 14.2949 6.88184 14.9502 6.04395 15.7881C5.20605 16.6188 4.55078 17.5892 4.07812 18.6992C3.60547 19.8021 3.36914 20.9837 3.36914 22.2441C3.36914 23.5046 3.60547 24.6862 4.07812 25.7891C4.55078 26.8919 5.20605 27.8623 6.04395 28.7002C6.88184 29.5381 7.85221 30.1934 8.95508 30.666C10.0579 31.1387 11.2396 31.375 12.5 31.375ZM7.4834 23.791C7.05371 23.791 6.6849 23.6406 6.37695 23.3398C6.07617 23.0319 5.92578 22.6631 5.92578 22.2334C5.92578 21.8037 6.07617 21.4385 6.37695 21.1377C6.6849 20.8298 7.05371 20.6758 7.4834 20.6758C7.90592 20.6758 8.27116 20.8298 8.5791 21.1377C8.88704 21.4385 9.04102 21.8037 9.04102 22.2334C9.04102 22.6631 8.88704 23.0319 8.5791 23.3398C8.27832 23.6406 7.91309 23.791 7.4834 23.791ZM12.4893 23.791C12.0667 23.791 11.7015 23.6406 11.3936 23.3398C11.0928 23.0319 10.9424 22.6631 10.9424 22.2334C10.9424 21.8037 11.0928 21.4385 11.3936 21.1377C11.7015 20.8298 12.0667 20.6758 12.4893 20.6758C12.9189 20.6758 13.2842 20.8298 13.585 21.1377C13.8929 21.4385 14.0469 21.8037 14.0469 22.2334C14.0469 22.6631 13.8929 23.0319 13.585 23.3398C13.2842 23.6406 12.9189 23.791 12.4893 23.791ZM17.5059 23.791C17.0762 23.791 16.7074 23.6406 16.3994 23.3398C16.0986 23.0319 15.9482 22.6631 15.9482 22.2334C15.9482 21.8037 16.0986 21.4385 16.3994 21.1377C16.7074 20.8298 17.0762 20.6758 17.5059 20.6758C17.9355 20.6758 18.3008 20.8298 18.6016 21.1377C18.9095 21.4385 19.0635 21.8037 19.0635 22.2334C19.0635 22.6631 18.9095 23.0319 18.6016 23.3398C18.3008 23.6406 17.9355 23.791 17.5059 23.791Z" fill="#E4AF0A"/>
</svg>
      </div>
    </div>
  </header>

  <!-- ЛИСТ -->
  <div class="sheet" aria-label="Лист заметки">
    <div class="note" contenteditable="true" role="textbox" aria-multiline="true" aria-label="Текст заметки" spellcheck="false">
      <div class="title"></div>
    </div>
  </div>

  <input type="file" accept="image/*" capture="environment" id="camera-input" style="display:none" aria-hidden="true" />

  <!-- НИЗ -->
  <footer class="toolbar" role="toolbar" aria-label="Панель инструментов">
    <div class="tool" aria-label="Пункты">
      <!-- ПУНКТЫ (жёлтый) -->
      <svg width="25" height="22" viewBox="0 0 25 22" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4.62988 21.6992C3.79199 21.6992 3.02214 21.488 2.32031 21.0654C1.61849 20.6429 1.05632 20.0807 0.633789 19.3789C0.211263 18.6771 0 17.9072 0 17.0693C0 16.2243 0.207682 15.4508 0.623047 14.749C1.04557 14.0472 1.60775 13.485 2.30957 13.0625C3.01139 12.64 3.78483 12.4287 4.62988 12.4287C5.47493 12.4287 6.24479 12.64 6.93945 13.0625C7.64128 13.4779 8.20345 14.0365 8.62598 14.7383C9.0485 15.4401 9.25977 16.2171 9.25977 17.0693C9.25977 17.9072 9.0485 18.6771 8.62598 19.3789C8.20345 20.0807 7.64128 20.6429 6.93945 21.0654C6.24479 21.488 5.47493 21.6992 4.62988 21.6992ZM4.62988 20.1309C5.18132 20.1309 5.68978 19.9912 6.15527 19.7119C6.62077 19.4326 6.99316 19.0602 7.27246 18.5947C7.55176 18.1292 7.69141 17.6208 7.69141 17.0693C7.69141 16.5107 7.55176 15.9987 7.27246 15.5332C6.99316 15.0677 6.62077 14.6953 6.15527 14.416C5.68978 14.1367 5.18132 13.9971 4.62988 13.9971C4.07845 13.9971 3.56999 14.1367 3.10449 14.416C2.639 14.6953 2.2666 15.0677 1.9873 15.5332C1.70801 15.9987 1.56836 16.5107 1.56836 17.0693C1.56836 17.6208 1.70801 18.1292 1.9873 18.5947C2.2666 19.0602 2.639 19.4326 3.10449 19.7119C3.56999 19.9912 4.07845 20.1309 4.62988 20.1309ZM12.5254 5.51074C12.2819 5.51074 12.0742 5.42839 11.9023 5.26367C11.7376 5.0918 11.6553 4.88411 11.6553 4.64062C11.6553 4.39714 11.7376 4.19303 11.9023 4.02832C12.0742 3.86361 12.2819 3.78125 12.5254 3.78125H23.2031C23.4466 3.78125 23.6543 3.86361 23.8262 4.02832C23.998 4.19303 24.084 4.39714 24.084 4.64062C24.084 4.88411 23.998 5.0918 23.8262 5.26367C23.6543 5.42839 23.4466 5.51074 23.2031 5.51074H12.5254ZM12.5254 17.9287C12.2819 17.9287 12.0742 17.8464 11.9023 17.6816C11.7376 17.5098 11.6553 17.3057 11.6553 17.0693C11.6553 16.8258 11.7376 16.6217 11.9023 16.457C12.0742 16.2852 12.2819 16.1992 12.5254 16.1992H23.2031C23.4466 16.1992 23.6543 16.2852 23.8262 16.457C23.998 16.6217 24.084 16.8258 24.084 17.0693C24.084 17.3057 23.998 17.5098 23.8262 17.6816C23.6543 17.8464 23.4466 17.9287 23.2031 17.9287H12.5254ZM4.62988 9.27051C3.79199 9.27051 3.02214 9.05924 2.32031 8.63672C1.61849 8.21419 1.05632 7.65202 0.633789 6.9502C0.211263 6.24837 0 5.47493 0 4.62988C0 3.78483 0.207682 3.01139 0.623047 2.30957C1.04557 1.60775 1.60775 1.04915 2.30957 0.633789C3.01139 0.211263 3.78483 0 4.62988 0C5.47493 0 6.24479 0.211263 6.93945 0.633789C7.64128 1.04915 8.20345 1.60775 8.62598 2.30957C9.0485 3.01139 9.25977 3.78483 9.25977 4.62988C9.25977 5.47493 9.0485 6.24837 8.62598 6.9502C8.20345 7.65202 7.64128 8.21419 6.93945 8.63672C6.24479 9.05924 5.47493 9.27051 4.62988 9.27051ZM4.08203 7.12207C4.31836 7.12207 4.50098 7.02181 4.62988 6.82129L6.875 3.29785C6.9681 3.14746 7.01465 3.00065 7.01465 2.85742C7.01465 2.72135 6.95736 2.60319 6.84277 2.50293C6.73535 2.40267 6.60645 2.35254 6.45605 2.35254C6.2627 2.35254 6.10156 2.4528 5.97266 2.65332L4.06055 5.72559L3.22266 4.66211C3.15104 4.56901 3.07585 4.50098 2.99707 4.45801C2.92546 4.41504 2.83594 4.39355 2.72852 4.39355C2.58529 4.39355 2.45996 4.44727 2.35254 4.55469C2.25228 4.66211 2.20215 4.7946 2.20215 4.95215C2.20215 5.11686 2.2487 5.25651 2.3418 5.37109L3.54492 6.82129C3.6237 6.91439 3.70247 6.98958 3.78125 7.04688C3.86719 7.09701 3.96745 7.12207 4.08203 7.12207Z" fill="#E4AF0A"/>
</svg>
</div>

    <div class="tool" aria-label="Камера">
      <!-- КАМЕРА (жёлтый) -->
      <svg width="27" height="21" viewBox="0 0 27 21" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M21.3232 8.23926C20.9508 8.23926 20.6357 8.11035 20.3779 7.85254C20.1201 7.58757 19.9912 7.27246 19.9912 6.90723C19.9912 6.53483 20.1201 6.21973 20.3779 5.96191C20.6357 5.7041 20.9508 5.5752 21.3232 5.5752C21.6885 5.5752 22 5.7041 22.2578 5.96191C22.5228 6.21973 22.6553 6.53483 22.6553 6.90723C22.6553 7.27246 22.5228 7.58757 22.2578 7.85254C22 8.11035 21.6885 8.23926 21.3232 8.23926ZM3.37305 20.4854C2.2487 20.4854 1.40365 20.2061 0.837891 19.6475C0.279297 19.096 0 18.2653 0 17.1553V5.9082C0 4.80534 0.279297 3.97819 0.837891 3.42676C1.40365 2.86816 2.2487 2.58887 3.37305 2.58887H6.37012C6.79264 2.58887 7.10417 2.53874 7.30469 2.43848C7.50521 2.33105 7.72363 2.14486 7.95996 1.87988L8.81934 0.913086C9.09147 0.619466 9.38509 0.39388 9.7002 0.236328C10.0225 0.078776 10.4593 0 11.0107 0H15.2969C15.8483 0 16.2852 0.078776 16.6074 0.236328C16.9297 0.39388 17.2233 0.619466 17.4883 0.913086L18.3477 1.87988C18.5124 2.05892 18.6592 2.20215 18.7881 2.30957C18.9242 2.40983 19.0781 2.48145 19.25 2.52441C19.4219 2.56738 19.651 2.58887 19.9375 2.58887H23.0098C24.127 2.58887 24.9684 2.86816 25.5342 3.42676C26.0999 3.97819 26.3828 4.80534 26.3828 5.9082V17.1553C26.3828 18.2653 26.0999 19.096 25.5342 19.6475C24.9684 20.2061 24.127 20.4854 23.0098 20.4854H3.37305ZM3.39453 18.7559H22.9775C23.5075 18.7559 23.9193 18.6162 24.2129 18.3369C24.5065 18.0505 24.6533 17.6279 24.6533 17.0693V6.00488C24.6533 5.44629 24.5065 5.02734 24.2129 4.74805C23.9193 4.46159 23.5075 4.31836 22.9775 4.31836H19.5078C19.0208 4.31836 18.627 4.26465 18.3262 4.15723C18.0326 4.04264 17.7497 3.83496 17.4775 3.53418L16.6396 2.58887C16.3317 2.24512 16.0596 2.01595 15.8232 1.90137C15.5869 1.78678 15.2324 1.72949 14.7598 1.72949H11.5479C11.0752 1.72949 10.7207 1.78678 10.4844 1.90137C10.248 2.01595 9.97591 2.24512 9.66797 2.58887L8.83008 3.53418C8.55794 3.83496 8.27148 4.04264 7.9707 4.15723C7.67708 4.26465 7.28678 4.31836 6.7998 4.31836H3.39453C2.86458 4.31836 2.4528 4.46159 2.15918 4.74805C1.87272 5.02734 1.72949 5.44629 1.72949 6.00488V17.0693C1.72949 17.6279 1.87272 18.0505 2.15918 18.3369C2.4528 18.6162 2.86458 18.7559 3.39453 18.7559ZM13.1914 17.209C12.375 17.209 11.6123 17.0586 10.9033 16.7578C10.1943 16.457 9.57129 16.0381 9.03418 15.501C8.50423 14.9639 8.08529 14.3408 7.77734 13.6318C7.47656 12.9229 7.32617 12.1566 7.32617 11.333C7.32617 10.5166 7.47656 9.75391 7.77734 9.04492C8.08529 8.33594 8.50423 7.71289 9.03418 7.17578C9.57129 6.63867 10.1943 6.21973 10.9033 5.91895C11.6123 5.61816 12.375 5.46777 13.1914 5.46777C14.2728 5.46777 15.2575 5.72917 16.1455 6.25195C17.0335 6.77474 17.7389 7.48014 18.2617 8.36816C18.7845 9.25618 19.0459 10.2445 19.0459 11.333C19.0459 12.1566 18.8955 12.9229 18.5947 13.6318C18.2939 14.3408 17.875 14.9639 17.3379 15.501C16.8008 16.0381 16.1777 16.457 15.4688 16.7578C14.7598 17.0586 14.0007 17.209 13.1914 17.209ZM13.1914 15.5762C13.972 15.5762 14.681 15.3864 15.3184 15.0068C15.9629 14.6273 16.4749 14.1188 16.8545 13.4814C17.234 12.8369 17.4238 12.1208 17.4238 11.333C17.4238 10.5524 17.234 9.84342 16.8545 9.20605C16.4749 8.56152 15.9629 8.04948 15.3184 7.66992C14.681 7.2832 13.972 7.08984 13.1914 7.08984C12.4108 7.08984 11.6982 7.2832 11.0537 7.66992C10.4163 8.04948 9.9043 8.56152 9.51758 9.20605C9.13802 9.84342 8.94824 10.5524 8.94824 11.333C8.94824 12.1208 9.13802 12.8369 9.51758 13.4814C9.9043 14.1188 10.4163 14.6273 11.0537 15.0068C11.6982 15.3864 12.4108 15.5762 13.1914 15.5762Z" fill="#E4AF0A"/>
</svg>
    </div>

    <div class="tool" aria-label="Маркер">
      <!-- МАРКЕР (жёлтый) -->
      <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M10.2588 6.08008C10.3376 5.85091 10.4736 5.69694 10.667 5.61816C10.8675 5.53939 11.0645 5.53939 11.2578 5.61816C11.4512 5.69694 11.5872 5.85091 11.666 6.08008L13.6855 12.1064H8.25L10.2588 6.08008ZM15.3291 20.0771C15.2145 20.0843 15.1071 20.0628 15.0068 20.0127C14.9137 19.9697 14.8314 19.9089 14.7598 19.8301C14.6953 19.7513 14.6523 19.6546 14.6309 19.54L13.1807 12.7295L13.3311 12.8262H8.60449L8.74414 12.7295L7.29395 19.54C7.25814 19.7262 7.15788 19.8695 6.99316 19.9697C6.83561 20.07 6.66374 20.1022 6.47754 20.0664C6.29134 20.0378 6.14453 19.9411 6.03711 19.7764C5.92969 19.6188 5.89388 19.4469 5.92969 19.2607L7.40137 12.3535C7.45866 12.0957 7.58398 11.8809 7.77734 11.709C7.9707 11.5299 8.19629 11.4404 8.4541 11.4404H13.4707C13.7285 11.4404 13.9541 11.5299 14.1475 11.709C14.348 11.8809 14.4733 12.0993 14.5234 12.3643L15.9951 19.2607C16.0381 19.4827 15.9772 19.6725 15.8125 19.8301C15.6478 19.9948 15.4867 20.0771 15.3291 20.0771ZM10.957 21.9141C9.44596 21.9141 8.02799 21.6276 6.70312 21.0547C5.37826 20.4889 4.21452 19.7048 3.21191 18.7021C2.20931 17.6995 1.42155 16.5358 0.848633 15.2109C0.282878 13.8861 0 12.4681 0 10.957C0 9.44596 0.282878 8.02799 0.848633 6.70312C1.42155 5.37826 2.20931 4.21452 3.21191 3.21191C4.21452 2.20215 5.37826 1.41439 6.70312 0.848633C8.02799 0.282878 9.44596 0 10.957 0C12.4681 0 13.8861 0.282878 15.2109 0.848633C16.5358 1.41439 17.6995 2.20215 18.7021 3.21191C19.7048 4.21452 20.4889 5.37826 21.0547 6.70312C21.6276 8.02799 21.9141 9.44596 21.9141 10.957C21.9141 12.4681 21.6276 13.8861 21.0547 15.2109C20.4889 16.5358 19.7048 17.6995 18.7021 18.7021C17.6995 19.7048 16.5358 20.4889 15.2109 21.0547C13.8861 21.6276 12.4681 21.9141 10.957 21.9141ZM10.957 20.0879C12.2174 20.0879 13.3991 19.8516 14.502 19.3789C15.6048 18.9062 16.5752 18.251 17.4131 17.4131C18.251 16.5752 18.9062 15.6048 19.3789 14.502C19.8516 13.3991 20.0879 12.2174 20.0879 10.957C20.0879 9.69661 19.8516 8.51497 19.3789 7.41211C18.9062 6.30208 18.251 5.33171 17.4131 4.50098C16.5752 3.66309 15.6048 3.00781 14.502 2.53516C13.3991 2.0625 12.2174 1.82617 10.957 1.82617C9.69661 1.82617 8.51497 2.0625 7.41211 2.53516C6.30924 3.00781 5.33887 3.66309 4.50098 4.50098C3.66309 5.33171 3.00781 6.30208 2.53516 7.41211C2.0625 8.51497 1.82617 9.69661 1.82617 10.957C1.82617 12.2174 2.0625 13.3991 2.53516 14.502C3.00781 15.6048 3.66309 16.5752 4.50098 17.4131C5.33887 18.251 6.30924 18.9062 7.41211 19.3789C8.51497 19.8516 9.69661 20.0879 10.957 20.0879Z" fill="#E4AF0A"/>
</svg>
    </div>

    <div class="tool muted" aria-label="Карандаш (неактивно)">
      <!-- ЗАМЕТКА/КАРАНДАШ (серый, не активный) -->
      <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3.37305 21.2373C2.25586 21.2373 1.41439 20.958 0.848633 20.3994C0.282878 19.848 0 19.0173 0 17.9072V5.53223C0 4.4222 0.282878 3.59147 0.848633 3.04004C1.41439 2.48145 2.25586 2.20215 3.37305 2.20215H15.5439L13.8145 3.93164H3.40527C2.86816 3.93164 2.4528 4.07487 2.15918 4.36133C1.87272 4.64779 1.72949 5.07031 1.72949 5.62891V17.8213C1.72949 18.3799 1.87272 18.8024 2.15918 19.0889C2.4528 19.3682 2.86816 19.5078 3.40527 19.5078H15.9629C16.3353 19.5078 16.6504 19.3682 16.9082 19.0889C17.1732 18.8024 17.3057 18.3799 17.3057 17.8213V7.50879L19.0352 5.7793V17.9072C19.0352 19.0173 18.7666 19.848 18.2295 20.3994C17.6995 20.958 16.9512 21.2373 15.9844 21.2373H3.37305ZM7.2832 14.2764C7.18294 14.3193 7.08984 14.2979 7.00391 14.2119C6.92513 14.1188 6.90723 14.0257 6.9502 13.9326L7.91699 11.9131L17.9395 1.89062L19.4111 3.34082L9.37793 13.3633L7.2832 14.2764ZM20.2061 2.55664L18.7344 1.07422L19.5186 0.300781C19.6976 0.128906 19.9017 0.0358073 20.1309 0.0214844C20.3672 0.00716146 20.5677 0.0823568 20.7324 0.24707L20.9795 0.504883C21.1657 0.683919 21.2552 0.891602 21.248 1.12793C21.248 1.3571 21.1585 1.56836 20.9795 1.76172L20.2061 2.55664Z" fill="#3C3C43" fill-opacity="0.3"/>
</svg>
    </div>
  </footer>

</body>
<script>
  (function(){
    const sheet = document.querySelector('.sheet');
    const note = document.querySelector('.note');
    const cameraTool = document.querySelector('.tool[aria-label="Камера"]');
    const cameraInput = document.getElementById('camera-input');
    const shareButton = document.querySelector('[data-role="share"]');
    const statusBarMeta = document.getElementById('status-bar-style');
    const darkScheme = window.matchMedia('(prefers-color-scheme: dark)');

    function applyStatusBarStyle(source){
      if (!statusBarMeta){
        return;
      }
      const isDark = typeof source.matches === 'boolean' ? source.matches : darkScheme.matches;
      statusBarMeta.setAttribute('content', isDark ? 'black' : 'default');
    }

    applyStatusBarStyle(darkScheme);
    if (typeof darkScheme.addEventListener === 'function'){
      darkScheme.addEventListener('change', applyStatusBarStyle);
    } else if (typeof darkScheme.addListener === 'function'){
      darkScheme.addListener(applyStatusBarStyle);
    }

    if (!sheet || !note) {
      return;
    }

    const TEXT_BLOCK_SELECTOR = '.title, .body';

    function createBlock(type){
      const block = document.createElement('div');
      block.classList.add(type);
      block.innerHTML = '';
      return block;
    }

    function ensureBlocks(){
      const children = Array.from(note.children);
      if (!children.length){
        note.appendChild(createBlock('title'));
      }

      let textIndex = 0;
      Array.from(note.children).forEach(child => {
        if (child.classList.contains('photo-block')){
          return;
        }

        const desired = textIndex === 0 ? 'title' : 'body';
        textIndex += 1;

        child.classList.remove('title', 'body');
        child.classList.add(desired);

        if (child.innerHTML === '<br>' || child.innerHTML === '<br />'){
          child.innerHTML = '';
        }
      });

      if (!textIndex){
        note.appendChild(createBlock('title'));
      }
    }

    function placeCaretInside(element){
      const selection = window.getSelection();
      const range = document.createRange();
      range.selectNodeContents(element);
      range.collapse(false);
      selection.removeAllRanges();
      selection.addRange(range);
    }

    function focusEnd(){
      ensureBlocks();
      const textBlocks = Array.from(note.querySelectorAll(TEXT_BLOCK_SELECTOR));
      const target = textBlocks.length ? textBlocks[textBlocks.length - 1] : note;
      note.focus({ preventScroll: true });
      placeCaretInside(target);
    }

    function insertBlockAfter(reference, block){
      if (reference && reference.parentElement === note){
        note.insertBefore(block, reference.nextSibling);
      } else {
        note.appendChild(block);
      }
    }

    function getCurrentBlock(){
      const selection = window.getSelection();
      if (!selection.rangeCount){
        return null;
      }
      const anchorNode = selection.anchorNode instanceof Element ? selection.anchorNode : selection.anchorNode?.parentElement;
      return anchorNode ? anchorNode.closest('.title, .body, .photo-block') : null;
    }

    sheet.addEventListener('pointerdown', event => {
      if (event.target.closest('.note') || event.target.closest('.toolbar')){
        return;
      }
      event.preventDefault();
      focusEnd();
    });

    function hasTypedContent(){
      return Array.from(note.querySelectorAll(TEXT_BLOCK_SELECTOR)).some(block => {
        const text = block.textContent || '';
        return text.replace(/[\s\u200B]+/g, '').length > 0;
      });
    }

    function hasMediaContent(){
      return !!note.querySelector('.photo-block');
    }

    function updateShareState(){
      if (!shareButton){
        return;
      }
      const active = hasTypedContent() || hasMediaContent();
      shareButton.classList.toggle('muted', !active);
      shareButton.setAttribute('aria-disabled', active ? 'false' : 'true');
    }

    note.addEventListener('focus', () => {
      ensureBlocks();
      updateShareState();
    });
    ensureBlocks();
    updateShareState();

    note.addEventListener('keydown', event => {
      if (event.key === 'Enter' && !event.shiftKey){
        event.preventDefault();
        const currentBlock = getCurrentBlock();
        const newBlock = createBlock('body');
        insertBlockAfter(currentBlock, newBlock);
        note.focus({ preventScroll: true });
        placeCaretInside(newBlock);
        ensureBlocks();
        updateShareState();
      }
    });

    note.addEventListener('input', () => {
      ensureBlocks();
      updateShareState();
    });

    cameraTool?.addEventListener('click', () => {
      note.focus({ preventScroll: true });
      cameraInput?.click();
    });

    cameraInput?.addEventListener('change', () => {
      const file = cameraInput.files && cameraInput.files[0];
      if (!file){
        return;
      }

      const reader = new FileReader();
      reader.addEventListener('load', () => {
        const block = document.createElement('div');
        block.className = 'photo-block';
        const img = document.createElement('img');
        img.src = String(reader.result);
        img.alt = 'Добавленное фото';
        block.appendChild(img);

        const currentBlock = getCurrentBlock();
        insertBlockAfter(currentBlock, block);

        ensureBlocks();
        updateShareState();

        let nextEditable = block.nextElementSibling;
        while (nextEditable && nextEditable.classList.contains('photo-block')){
          nextEditable = nextEditable.nextElementSibling;
        }

        if (!nextEditable){
          nextEditable = createBlock('body');
          note.insertBefore(nextEditable, block.nextSibling);
        }

        note.focus({ preventScroll: true });
        placeCaretInside(nextEditable);
      });

      reader.readAsDataURL(file);
      cameraInput.value = '';
    });
  })();
</script>
</body>
</html>
